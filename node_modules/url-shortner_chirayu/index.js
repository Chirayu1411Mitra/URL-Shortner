const http = require('http');
const { resolve } = require('path');

function ShortenURL(URL){
    return new Promise((resolve,reject)=>{
        if(!URL || typeof URL !== 'string'){
            return reject(new Error('INvalid URL'))
        }
        const apiURL = `http://tinyurl.com/api-create.php?url=${encodeURIComponent(URL)}`;
        const request = http.get(apiURL,(res) => {
            if(res.statusCode !==200){
                return reject(new Error(`Failed to get a response`))
            }
            let data ='';
            res.on('data',(chunk)=>{
                data +=chunk;
            })
            res.on('end',()=>{
                resolve(data)
            });
        });
        request.on('error',(e) =>{
            reject(new Error(`An error occured while making request:${e.message}`));

        });
    });
}
module.exports={ShortenURL};